# /etc/nginx/snippets/security-headers.conf
# Shared security headers for inclusion in server blocks
# Apply these with: include /etc/nginx/snippets/security-headers.conf;

# HSTS - long max-age, include subdomains, and preload directive
add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload" always;

# Clickjacking protection (use SAMEORIGIN to avoid breaking legit embeds)
add_header X-Frame-Options "SAMEORIGIN" always;

# Prevent MIME-sniffing
add_header X-Content-Type-Options "nosniff" always;

# Recommended referrer policy
add_header Referrer-Policy "strict-origin-when-cross-origin" always;

# Basic XSS protection (legacy; harmless to keep)
add_header X-XSS-Protection "1; mode=block" always;


# Deny non-secure embedding of your site in older browsers that honor CSP frame-ancestors
# Note: prefer CSP frame-ancestors in site config for modern browsers; keep X-Frame-Options as fallback
